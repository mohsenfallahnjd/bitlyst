
<svg width="940" height="300" viewBox="0 0 940 300" xmlns="http://www.w3.org/2000/svg" role="img" aria-label="Microtask vs Macrotask flow: script → microtasks → macrotask">
  <defs>
    <style>
      .lane { fill: #f1f5f9; }
      .box { fill: #ffffff; stroke: #0ea5e9; stroke-width: 2; rx: 10; }
      .mic { stroke: #22c55e; }
      .mac { stroke: #f59e0b; }
      .label { font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial; font-size: 14px; fill: #0f172a; }
      .title { font-weight: 700; font-size: 16px; }
      .arrow { stroke: #0f172a; stroke-width: 2; marker-end: url(#arrow); }
      .note { fill: #64748b; font-size: 12px; }
    </style>
    <marker id="arrow" viewBox="0 0 10 10" refX="8" refY="5" markerWidth="8" markerHeight="8" orient="auto-start-reverse">
      <path d="M 0 0 L 10 5 L 0 10 z" fill="#0f172a"/>
    </marker>
  </defs>

  <!-- Lanes -->
  <rect x="20" y="40" width="900" height="50" class="lane" />
  <text x="30" y="35" class="label title">Script (synchronous)</text>

  <rect x="20" y="130" width="900" height="50" class="lane" />
  <text x="30" y="125" class="label title">Microtask Queue (Promises, queueMicrotask, MutationObserver)</text>

  <rect x="20" y="220" width="900" height="50" class="lane" />
  <text x="30" y="215" class="label title">Macrotask Queue (setTimeout, setInterval, rAF, DOM events)</text>

  <!-- Script boxes -->
  <rect x="120" y="45" width="110" height="35" class="box"/>
  <text x="175" y="67" text-anchor="middle" class="label">Start</text>

  <rect x="260" y="45" width="140" height="35" class="box"/>
  <text x="330" y="67" text-anchor="middle" class="label">schedule setTimeout</text>

  <rect x="430" y="45" width="140" height="35" class="box"/>
  <text x="500" y="67" text-anchor="middle" class="label">schedule Promise.then</text>

  <rect x="600" y="45" width="110" height="35" class="box"/>
  <text x="655" y="67" text-anchor="middle" class="label">End</text>

  <!-- Microtask items -->
  <rect x="420" y="135" width="160" height="35" class="box mic"/>
  <text x="500" y="158" text-anchor="middle" class="label">Promise.then</text>

  <!-- Macrotask items -->
  <rect x="260" y="225" width="160" height="35" class="box mac"/>
  <text x="340" y="248" text-anchor="middle" class="label">setTimeout callback</text>

  <!-- Arrows -->
  <line x1="230" y1="62" x2="260" y2="62" class="arrow"/>
  <line x1="400" y1="62" x2="430" y2="62" class="arrow"/>
  <line x1="570" y1="62" x2="600" y2="62" class="arrow"/>

  <line x1="500" y1="80" x2="500" y2="135" class="arrow"/>
  <line x1="330" y1="80" x2="330" y2="225" class="arrow"/>

  <!-- Order text -->
  <text x="760" y="40" class="label title">Console order:</text>
  <text x="760" y="60" class="label">1) Start</text>
  <text x="760" y="78" class="label">2) End</text>
  <text x="760" y="96" class="label">3) Promise</text>
  <text x="760" y="114" class="label">4) setTimeout</text>

  <!-- Notes -->
  <text x="20" y="295" class="note">Event loop cycle: run one macrotask → drain all microtasks → render → repeat.</text>
</svg>
